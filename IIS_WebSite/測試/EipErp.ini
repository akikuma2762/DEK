[dekERPVIS]
recordsofchangetheorder_details= SELECT distinct a.客戶名稱,a.訂單號碼,a.SN, a.變更欄位,a.變更日期,a.備註,a.變更前內容,a.變更後內容,mkordsub.item_no AS CCS, mkordsub.lot_no AS 機號,CITEM_NO AS 客戶機種 FROM (SELECT cust.CUST_NO AS 客戶代號, cust.CUSTNM2 AS 客戶名稱,CORD_CH_VERIFY.CORD_NO AS 訂單號碼,CORD_CH_VERIFY.CORD_SN AS SN, CH_OBJECT AS 變更欄位,APPROVE_DATE AS 變更日期,CORD_CH_VERIFY.REMARK AS 備註,BEFORE_CH_CONTENT AS 變更前內容,SNO, (CASE WHEN LEN(AFTER_CH_D_DATE) > 0 THEN AFTER_CH_D_DATE ELSE (CASE WHEN LEN(AFTER_CH_ITEM_NO) > 0 THEN AFTER_CH_ITEM_NO ELSE (CASE WHEN AFTER_CH_QTY > 0 THEN CONVERT(varchar, AFTER_CH_QTY) ELSE (CASE WHEN LEN(AFTER_CH_SCLOSE) > 0 THEN AFTER_CH_SCLOSE ELSE '' END) END) END) END) AS 變更後內容 FROM FJWSQL.dbo.CORD_CH_VERIFY LEFT JOIN FJWSQL.dbo.CORDSUB ON CORDSUB.TRN_NO = CORD_CH_VERIFY.CORD_NO AND CORDSUB.SN = CORD_CH_VERIFY.CORD_SN LEFT JOIN FJWSQL.dbo.cust ON CUST.CUST_NO = CORDSUB.CUST_NO WHERE {0}  <=  APPROVE_DATE     AND APPROVE_DATE<={1} AND CH_OBJECT IS NOT NULL AND LEN(CH_OBJECT)>0 ) AS a LEFT JOIN FJWSQL.dbo.mkordsub ON a.訂單號碼 = mkordsub.cord_no AND a.SN = mkordsub.cord_sn LEFT JOIN FJWSQL.dbo.CITEM ON CITEM.CUST_NO = a.客戶代號 AND CITEM.ITEM_NO = mkordsub.item_no 
SupplierShortage_Delivery= SELECT  ORIGIN_TRN_NO 單號, urge_item_b2b.FACT_NO AS 廠商代碼, ITEM_NO AS 品號, sum(in_qty) AS 收貨量,urge_item_b2b.SOITEM_NO 加工代號 FROM urge_item_b2b LEFT JOIN fjwsql.dbo.fact ON urge_item_b2b.fact_no = fact.fact_no {0} AND urge_trn_no = (SELECT max(urge_trn_no) FROM urge_item_b2b) GROUP BY urge_item_b2b.FACT_NO, ITEM_NO, ORIGIN_TRN_NO,urge_item_b2b.SOITEM_NO HAVING Sum(in_qty) IS NOT NULL
Change_Date_To_Now= SELECT DISTINCT a.客戶名稱,a.訂單號碼,a.SN, a.變更欄位,a.變更日期,a.備註,a.變更前內容,a.變更後內容,mkordsub.item_no AS CCS, mkordsub.lot_no AS 機號,CITEM_NO AS 客戶機種 FROM (SELECT cust.CUST_NO AS 客戶代號, cust.CUSTNM2 AS 客戶名稱,CORD_CH_VERIFY.CORD_NO AS 訂單號碼,CORD_CH_VERIFY.CORD_SN AS SN, CH_OBJECT AS 變更欄位,APPROVE_DATE AS 變更日期,CORD_CH_VERIFY.REMARK AS 備註,BEFORE_CH_CONTENT AS 變更前內容,SNO, AFTER_CH_D_DATE AS 變更後內容 FROM FJWSQL.dbo.CORD_CH_VERIFY LEFT JOIN FJWSQL.dbo.CORDSUB ON CORDSUB.TRN_NO = CORD_CH_VERIFY.CORD_NO AND CORDSUB.SN = CORD_CH_VERIFY.CORD_SN LEFT JOIN FJWSQL.dbo.cust ON CUST.CUST_NO = CORDSUB.CUST_NO WHERE  CH_OBJECT IS NOT NULL AND LEN(CH_OBJECT)>0  AND CH_OBJECT = '預交日' AND  {0} <= AFTER_CH_D_DATE  AND AFTER_CH_D_DATE <=  {1}  and BEFORE_CH_CONTENT < {0}) AS a LEFT JOIN FJWSQL.dbo.mkordsub ON a.訂單號碼 = mkordsub.cord_no AND a.SN = mkordsub.cord_sn LEFT JOIN FJWSQL.dbo.CITEM ON CITEM.CUST_NO = a.客戶代號 AND CITEM.ITEM_NO = mkordsub.item_no
Change_Date_To_Other= SELECT DISTINCT a.客戶名稱,a.訂單號碼,a.SN, a.變更欄位,a.變更日期,a.備註,a.變更前內容,a.變更後內容,mkordsub.item_no AS CCS, mkordsub.lot_no AS 機號,CITEM_NO AS 客戶機種 FROM (SELECT cust.CUST_NO AS 客戶代號, cust.CUSTNM2 AS 客戶名稱,CORD_CH_VERIFY.CORD_NO AS 訂單號碼,CORD_CH_VERIFY.CORD_SN AS SN, CH_OBJECT AS 變更欄位,APPROVE_DATE AS 變更日期,CORD_CH_VERIFY.REMARK AS 備註,BEFORE_CH_CONTENT AS 變更前內容,SNO, AFTER_CH_D_DATE AS 變更後內容 FROM FJWSQL.dbo.CORD_CH_VERIFY LEFT JOIN FJWSQL.dbo.CORDSUB ON CORDSUB.TRN_NO = CORD_CH_VERIFY.CORD_NO AND CORDSUB.SN = CORD_CH_VERIFY.CORD_SN LEFT JOIN FJWSQL.dbo.cust ON CUST.CUST_NO = CORDSUB.CUST_NO WHERE  CH_OBJECT IS NOT NULL AND LEN(CH_OBJECT)>0  AND CH_OBJECT = '預交日' AND  {0} <= BEFORE_CH_CONTENT  AND BEFORE_CH_CONTENT <=  {1}  and ( AFTER_CH_D_DATE < {0} OR {1} < AFTER_CH_D_DATE )) AS a LEFT JOIN FJWSQL.dbo.mkordsub ON a.訂單號碼 = mkordsub.cord_no AND a.SN = mkordsub.cord_sn LEFT JOIN FJWSQL.dbo.CITEM ON CITEM.CUST_NO = a.客戶代號 AND CITEM.ITEM_NO = mkordsub.item_no
Change_Now_To_Now= SELECT DISTINCT a.客戶名稱,a.訂單號碼,a.SN, a.變更欄位,a.變更日期,a.備註,a.變更前內容,a.變更後內容,mkordsub.item_no AS CCS, mkordsub.lot_no AS 機號,CITEM_NO AS 客戶機種 FROM (SELECT cust.CUST_NO AS 客戶代號, cust.CUSTNM2 AS 客戶名稱,CORD_CH_VERIFY.CORD_NO AS 訂單號碼,CORD_CH_VERIFY.CORD_SN AS SN, CH_OBJECT AS 變更欄位,APPROVE_DATE AS 變更日期,CORD_CH_VERIFY.REMARK AS 備註,BEFORE_CH_CONTENT AS 變更前內容,SNO, AFTER_CH_D_DATE AS 變更後內容 FROM FJWSQL.dbo.CORD_CH_VERIFY LEFT JOIN FJWSQL.dbo.CORDSUB ON CORDSUB.TRN_NO = CORD_CH_VERIFY.CORD_NO AND CORDSUB.SN = CORD_CH_VERIFY.CORD_SN LEFT JOIN FJWSQL.dbo.cust ON CUST.CUST_NO = CORDSUB.CUST_NO WHERE  CH_OBJECT IS NOT NULL AND LEN(CH_OBJECT)>0  AND CH_OBJECT = '預交日' AND  {0} <= AFTER_CH_D_DATE  AND AFTER_CH_D_DATE <=  {1} AND   {0} <= BEFORE_CH_CONTENT  AND BEFORE_CH_CONTENT <=  {1} ) AS a LEFT JOIN FJWSQL.dbo.mkordsub ON a.訂單號碼 = mkordsub.cord_no AND a.SN = mkordsub.cord_sn LEFT JOIN FJWSQL.dbo.CITEM ON CITEM.CUST_NO = a.客戶代號 AND CITEM.ITEM_NO = mkordsub.item_no

[Get_Item]
MaxOrder= select max( TRN_NO)  催料表日期 from urge_item
[Parameter]
SupplierShortage_Column= urge_trn_no

[TQMFApE3+5Du0l8cFTFILw==]
inikey1=tJARhN5XPIuh3cUW5Q0TrQ==
inikey=TQMFApE3+5Du0l8cFTFILw==
inikey2=kp02nPT/BEbIj9IcEn0aUQ==
inikey3=i1zbC1szER00ixO+TGqRMA==
inikey4=gOkD7Wci3cZoYkcj5dns3Q==
[db_name]
inikey=Eip
