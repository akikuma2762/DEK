[dekERPVIS]
Orders_Details=SELECT item_22.pline_no 產線代號,cust.custnm2 客戶簡稱, mkordsub.item_no CCS, mkordsub.lot_no 製造批號, cordsub.sclose 訂單狀況, EMPLOY.Name 業務員, cordsub.d_date 預交日,a22_fab.str_date 預計開工日, {3} INVOSUB.TRN_DATE 出貨日, CONVERT(VARCHAR(12), CONVERT(MONEY, cordsub.quantity), 1) 數量,cordsub.amount 金額,(CASE WHEN substring(cordsub.d_date, 7, 2) <=25 THEN substring(cordsub.d_date, 1, 6) WHEN substring(cordsub.d_date, 7, 2) >=25 THEN CASE WHEN substring(cordsub.d_date, 5, 2) = 12 THEN (cast(substring(cordsub.d_date, 1, 4)+1 AS varchar) + '01') ELSE substring(cordsub.d_date, 1, 6)+1 END END) 計算月份 FROM cordsub LEFT JOIN a22_fab ON cordsub.trn_no = a22_fab.cord_no AND cordsub.sn = a22_fab.cord_sn LEFT JOIN mkordsub ON cordsub.trn_no = mkordsub.cord_no AND cordsub.sn = mkordsub.cord_sn LEFT JOIN item_22 ON item_22.item_no = cordsub.item_no LEFT JOIN cord ON cord.trn_no = cordsub.trn_no LEFT JOIN cust ON cust.cust_no = case when LEN(cordsub.cust_no)=0 then  cord.CUST_NO else cordsub.cust_no end   LEFT JOIN EMPLOY ON EMPLOY.EMP_NO = CORD.USER_CODE LEFT JOIN INVOSUB ON cordsub.TRN_NO=INVOSUB.CORD_NO AND cordsub.SN=INVOSUB.CORD_SN and INVOSUB.lot_no = mkordsub.lot_no WHERE  100<= item_22.pline_no and item_22.pline_no <=199 AND ((case when INVOSUB.TRN_DATE is null then cordsub.D_DATE when INVOSUB.TRN_DATE<= CORDSUB.D_DATE then INVOSUB.TRN_DATE else   CORDSUB.D_DATE end  )  >= {0} AND (case when INVOSUB.TRN_DATE is null then cordsub.D_DATE when INVOSUB.TRN_DATE<= CORDSUB.D_DATE then INVOSUB.TRN_DATE else   CORDSUB.D_DATE end  )  <= {1} OR(cordsub.d_date>={0} AND cordsub.d_date<={1})) {2} order by CORDSUB.D_DATE asc
Orders_Over_Detail= SELECT item_22.pline_no AS 產線代號,cust.custnm2 AS 客戶簡稱, isnull( mkordsub.item_no ,cordsub.item_no) AS CCS, mkordsub.lot_no AS 製造批號, cordsub.sclose AS 訂單狀況,EMPLOY.Name 業務員,cordsub.d_date 預交日, a22_fab.str_date AS 預計開工日, {1} INVOSUB.TRN_DATE 出貨日,  CONVERT(VARCHAR(12), CONVERT(MONEY, cordsub.quantity), 1) AS 數量,cordsub.amount 金額 FROM cordsub AS cordsub LEFT JOIN a22_fab ON cordsub.trn_no = a22_fab.cord_no AND cordsub.sn = a22_fab.cord_sn LEFT JOIN mkordsub AS mkordsub ON cordsub.trn_no = mkordsub.cord_no AND cordsub.sn = mkordsub.cord_sn LEFT JOIN cust AS cust ON cust.cust_no = cordsub.cust_no LEFT JOIN INVOSUB ON cordsub.TRN_NO=INVOSUB.CORD_NO AND cordsub.SN=INVOSUB.CORD_SN and INVOSUB.lot_no = mkordsub.lot_no LEFT JOIN item_22 AS item_22 ON item_22.item_no = cordsub.item_no LEFT JOIN cord AS cord ON cord.trn_no = cordsub.trn_no LEFT JOIN EMPLOY ON EMPLOY.EMP_NO = CORD.USER_CODE WHERE 100<= item_22.pline_no and item_22.pline_no <=199 AND cordsub.d_date < {0} AND (CORDSUB.SCLOSE ='未結' OR INVOSUB.TRN_DATE >={0})
Shipment_Detail = SELECT  item_22.PLINE_NO AS 產線代號, cust.custnm2 AS 客戶簡稱,INVOSUB.ITEM_NO AS 品號,INVOSUB.itemnm AS 品名規格,INVOSUB.QUANTITY AS 小計 FROM INVOSUB LEFT JOIN CUST AS cust ON cust.CUST_NO=INVOSUB.CUST_NO LEFT JOIN CORDSUB AS cordsub ON cordsub.TRN_NO=INVOSUB.CORD_NO AND cordsub.SN=INVOSUB.CORD_SN LEFT JOIN item_22 AS item_22 ON INVOSUB.ITEM_NO=item_22.ITEM_NO LEFT JOIN item AS item ON INVOSUB.ITEM_NO=item.ITEM_NO WHERE invosub.TRN_DATE>={0} AND invosub.TRN_DATE<={1} AND item.class>='Z' AND item.class<= 'ZR' AND 100<= item_22.pline_no and item_22.pline_no <=199
Get_Shipment= SELECT INVOSUB.TRN_DATE AS 出貨日期,INVOSUB.TRN_NO AS 出貨單號,mkordsub.LOT_NO AS 製造批號,mkordsub.ITEM_NO AS CCS,invosub.QUANTITY 數量, CORDSUB.REMARK AS 訂單備註 FROM INVOSUB LEFT JOIN CUST AS cust ON cust.CUST_NO=INVOSUB.CUST_NO LEFT JOIN CORDSUB AS cordsub ON cordsub.TRN_NO=INVOSUB.CORD_NO AND cordsub.SN=INVOSUB.CORD_SN LEFT JOIN MKORDSUB AS mkordsub ON cordsub.TRN_NO=mkordsub.CORD_NO AND cordsub.SN=mkordsub.CORD_SN LEFT JOIN item_22 AS item_22 ON INVOSUB.ITEM_NO=item_22.ITEM_NO LEFT JOIN item AS item ON INVOSUB.ITEM_NO=item.ITEM_NO WHERE invosub.TRN_DATE>={0} AND invosub.TRN_DATE<={1} AND item.class>='Z' AND item.class<= 'ZR' AND cust.custnm2='{2}' AND INVOSUB.ITEM_NO = '{3}' ORDER BY INVOSUB.TRN_DATE DESC
UntradedCustomer= SELECT * FROM (SELECT cust.CUSTNM2 AS 客戶簡稱,max(TRN_DATE) AS 最後交易日,DATEDIFF(DAY, max(TRN_DATE), convert(varchar(10), getdate(), 112)) AS 未交易天數 FROM cord LEFT JOIN CUST AS cust ON cust.CUST_NO=cord.CUST_NO WHERE cust.CUSTNM2 IS NOT NULL GROUP BY cust.CUSTNM2) AS A WHERE 未交易天數 {0} {1} {2}   ORDER BY 未交易天數 DESC
Supplierscore_Detail= select a.* ,CONVERT(NUMERIC(17, 2), CONVERT(FLOAT, Round(((CONVERT(NUMERIC(17, 2), a.期限內已交數量)) / CONVERT(NUMERIC(17, 2), a.採購數量)) * 100, 2))) AS 達交率 from ( SELECT  fact.factnm2 AS 供應商,sord.trn_no AS 採購單號,  sordsub.sn AS 採購明細序,    sordsub.item_no AS 品號,  sordsub.NAME AS 品名規格,  sordsub.quantity AS 採購數量,  sum(purcsub.q_delied) AS 期限內已交數量,  sord.trn_date AS 採購單日期,  sordsub.d1 AS 預交日期,  max(purcsub.trn_date) AS 期限內最後進貨日期 FROM sord LEFT JOIN sordsub ON sord.trn_no = sordsub.trn_no LEFT JOIN purcsub ON purcsub.sord_no = sord.trn_no LEFT JOIN fact ON fact.fact_no = sord.fact_no WHERE  sordsub.d1 >= {0} AND sordsub.d1 <= {1} AND purcsub.sord_sn = sordsub.sn AND sordsub.d1 >= purcsub.trn_date group by sord.trn_no,sordsub.sn,fact.factnm2 ,sordsub.item_no,sordsub.quantity,sord.trn_date ,sordsub.d1,sordsub.NAME ) a
materialrequirementplanning_Detail= SELECT  ITEMIOS.TRN_NO AS 領料單號, ITEMIOS.TRN_date AS 領料單日期, ITEMIOS.item_no AS 領料單明細品號, ITEM.itemnm AS 領料單明細品名規格, itemios.qty2 AS 領料數量, (CASE WHEN CHARINDEX('(', ITEMIOS.S_DESC COLLATE Latin1_General_CS_AS) > 0 THEN SUBSTRING(ITEMIOS.S_DESC, 0, CHARINDEX('(', ITEMIOS.S_DESC)) ELSE ITEMIOS.S_DESC END) AS 用途說明, itemios.mkord_no AS 製令單號, (SELECT top 1 mkordsub.ITEM_NO FROM mkordsub WHERE ITEMIOS.MKORD_NO = mkordsub.TRN_NO) AS 製令明細品號, (SELECT item.ITEMNM FROM item WHERE item.ITEM_NO = (SELECT top 1 mkordsub.ITEM_NO FROM mkordsub WHERE ITEMIOS.MKORD_NO = mkordsub.TRN_NO)) AS 製令明細品名規格, ISNULL(CUST.CUSTNM2,'未填寫') AS 使用客戶 FROM ITEMIOS LEFT JOIN item AS item ON ITEMIOS.ITEM_NO = item.ITEM_NO LEFT JOIN CUST AS CUST ON itemios.CUST_NO = CUST.CUST_NO WHERE  TRN_DATE>= {0} AND TRN_DATE<= {1} AND itemios.qty2 >0 {2} ORDER BY ITEMIOS.TRN_date
pick_list_datatable= SELECT itemios.item_no AS 品號, (SELECT itemnm FROM item WHERE item.item_no=itemios.item_no) AS 品名規格, itemios.PLACE AS 倉位, itemios.unit AS 單位, cast(itemios.PQTY_H AS numeric(20, 2)) AS 現有庫存, cast(itemios.QTY1 AS numeric(20, 2)) AS 申請數量, cast(itemios.QTY2 AS numeric(20, 2)) AS 領料數量, cast(itemios.QTYNG AS numeric(20, 2)) AS 不足數量, (SELECT SCLOSE FROM mkordis WHERE mkordis.trn_no=itemios.mkord_no AND mkordis.item_no=itemios.item_no) AS 狀況,ISnull(itemio.LOT_NO,itemio.mkord_no) 刀庫或製令 FROM itemios LEFT JOIN itemio ON itemios.trn_no = itemio.trn_no WHERE itemio.IO='1' {0} order by itemios.item_no, cast(itemios.PQTY_H AS numeric(20, 2))
pick_list_title= SELECT itemio.trn_no AS 領料單號,itemio.trn_date AS 領料日期, (SELECT name FROM employ WHERE itemio.user_code=employ.emp_no) AS 領料人,itemio.mkord_no AS 製令單號, (SELECT cord_no FROM mkord WHERE mkord.trn_no=itemio.mkord_no) AS 訂單號碼, itemio.s_desc AS 用途說明, (SELECT name FROM employ WHERE ITEMIO.STOCK=employ.emp_no) AS 倉管,itemio.LOT_NO AS 製造批號, (SELECT CUST.CUSTNM2 FROM CUST  WHERE CUST.cust_no= (SELECT cust_no FROM mkord WHERE mkord.trn_no=itemio.mkord_no)) AS 客戶簡稱, itemio.MITEM_NO AS 產品組件, cast(itemio.BOM_QTY AS numeric(20, 2)) AS 領料台數 FROM itemio WHERE IO='1' {0}
Inventory_Total_Amount= SELECT item.item_no AS 品號,itemnm AS 品名規格,CLASS.C_NAME AS 物料類別,    CASE item.NOUSE WHEN 'Y' THEN '是' ELSE ''      END 是否停用,ITEM_GD.GDNO AS 倉位,ITEM_GD.qty AS 庫存數量,SCOST AS 庫存金額,(ITEM_GD.qty*SCOST) AS 總庫存金額 FROM item LEFT JOIN ITEM_GD ON ITEM_GD.ITEM_NO = ITEM.ITEM_NO  AND ITEM_GD.QTY >0 LEFT JOIN CLASS ON CLASS.CLASS = ITEM.CLASS WHERE PQTY_H>0 {0} {1} ORDER BY item.item_no
InactiveInventory= SELECT isnull(b.最後領料日,'---')  最後領料日,a.品號,b.品名規格,b.倉位,b.類別,a.庫存數量 剩餘總庫存 ,a.領用數量,a.銷貨數量,(a.庫存數量+a.領用數量+a.銷貨數量-a.入庫數量) 期初庫存,((a.領用數量+a.銷貨數量)*100/(a.庫存數量+a.領用數量+a.銷貨數量-a.入庫數量))  領用比例 ,b.標準成本 , b.標準成本 * a.庫存數量 金額小計,b.儲位 FROM (SELECT item.item_no  品號, ISNULL(ITEM.PQTY_H, 0)  庫存數量, ISNULL( (SELECT sum(ITEMIOS.QTY2) FROM itemios WHERE itemios.item_no=item.item_no AND itemios.io=1 AND itemios.trn_date>{0} AND itemios.trn_date<{1} GROUP BY itemios.item_no),0)  領用數量, ISNULL( (SELECT sum(ITEMIOS.QTY2) FROM itemios WHERE itemios.item_no=item.item_no AND itemios.io=2 AND itemios.trn_date>{0} AND itemios.trn_date<{1} GROUP BY itemios.item_no),0)  入庫數量, ISNULL( (SELECT sum(invosub.QUANTITY) FROM invosub WHERE invosub.item_no=item.item_no AND TYPE=1 AND invosub.trn_date>{0} AND invosub.trn_date<{1} GROUP BY invosub.item_no),0)  銷貨數量 FROM item LEFT JOIN ITEM_GD ON ITEM_GD.ITEM_NO = ITEM.ITEM_NO WHERE ITEM.PQTY_H>0 {2} AND ITEM.COQTY = 0 AND ITEM.ISQTY = 0 AND ITEM.SMQTY >= 0 AND ITEM.SOQTY >= 0 AND ITEM_GD.QTY > 0 {3} )  a LEFT JOIN (SELECT DISTINCT ITEM.item_no  品號, ITEM.ITEMNM  品名規格, ITEM.PQTY_H  庫存數, ITEM.PLACE  倉位, MAX(itemios.trn_date)  最後領料日, ITEM_GD.GDNO  儲位 , ITEM.SCOST  標準成本,CLASS.C_NAME  類別 FROM ITEM LEFT JOIN itemios ON itemios.ITEM_NO = ITEM.ITEM_NO LEFT JOIN ITEM_GD ON ITEM_GD.ITEM_NO = ITEM.ITEM_NO LEFT JOIN CLASS ON CLASS.CLASS = ITEM.CLASS WHERE ITEM_GD.QTY > 0 {2} {3} GROUP BY ITEM.ITEM_NO, ITEM.ITEMNM, ITEM.PQTY_H, ITEM.PLACE, ITEM_GD.GDNO, ITEM.SCOST, CLASS.C_NAME)  b ON a.品號 = b.品號 AND a.庫存數量 = b.庫存數 order by 領用比例 
Scrapped= SELECT ITEMIO.STOCKNAME AS 報廢者,ITEMIOS.TRN_NO AS 單據號碼, ITEMIOS.TRN_DATE AS 單據日期, ITEM.ITEM_NO AS 品號,ITEM.ITEMNM AS 品名規格, ITEM.UNIT AS 單位, ITEM.SCOST AS 標準成本 , ITEMIOS.IRQTY AS 報廢數量, (ITEM.SCOST*ITEMIOS.IRQTY) AS 金額小計, ITEMIO.REMARK AS 備註 FROM ITEM AS ITEM LEFT JOIN ITEMIOS AS ITEMIOS ON ITEM.ITEM_NO = ITEMIOS.ITEM_NO AND ITEMIOS.IO='3' LEFT JOIN ITEMIO AS ITEMIO ON ITEMIOS.IO=ITEMIO.IO AND ITEMIOS.TRN_NO=ITEMIO.TRN_NO LEFT JOIN DEP AS DEP ON ITEMIO.D_NO=DEP.S_NO WHERE ITEMIOS.IRQTY <> 0 AND ITEMIOS.WASTES_SW2='Y' AND ITEMIOS.TRN_DATE >= {0} AND ITEMIOS.TRN_DATE <= {1}  {2}   order by 金額小計 desc
stockanalysis_details= SELECT a.客戶簡稱,a.產線代號,a.製造批號,a.入庫日,DATEDIFF(DAY, Cast(a.入庫日 AS DATETIME), GETUTCDATE()) 庫存天數,a.庫存金額,a.庫存原因 FROM (SELECT cust.custnm2 AS 客戶簡稱,A22_FAB.FAB_USER AS 產線代號 ,mkordsub.LOT_NO 製造批號, (SELECT MAX(ITEMIO.TRN_DATE) FROM ITEMIOS, ITEMIO WHERE ITEMIOS.IO=ITEMIO.IO AND ITEMIOS.TRN_NO=ITEMIO.TRN_NO AND ITEMIOS.IO='2' AND ITEMIOS.MKORD_NO=MKORDSUB.TRN_NO AND ITEMIOS.MKORD_SN=MKORDSUB.SN AND ITEMIO.S_DESC< >'歸還' AND ITEMIO.MK_TYPE='成品入庫') 入庫日, cordsub.AMOUNT 庫存金額,A22_FAB.USER_FIELD08 庫存原因 FROM A22_FAB, CORDSUB, MKORDSUB, CUST,item WHERE A22_FAB.CORD_NO=cordsub.TRN_NO AND A22_FAB.CORD_SN=cordsub.SN AND mkordSUB.CORD_NO=CORDSUB.trn_no AND mkordsub.CORD_SN=cordsub.sn AND CUST.CUST_NO=CORDsub.CUST_NO and CORDSUB.ITEM_NO=item.ITEM_NO AND cordsub.SCLOSE !='結案' AND item.class = 'Z-H' ) a WHERE a.入庫日 <> '' and 100<=a.產線代號 and a.產線代號<=199
Transportrackstatistics= SELECT '('+a.客戶代號+')'+a.客戶簡稱 客戶簡稱,a.運輸架品號,ISNULL(sum(a.數量), 0) 正常數量 ,ISNULL(sum(b.數量), 0) 異常數量 FROM (SELECT cust.cust_no 客戶代號,cust.custnm2 AS 客戶簡稱,INVOSUB.ITEM_NO AS 運輸架品號, (CASE WHEN cust.custnm2='MA' AND INVOSUB.ITEM_NO='MR4CM00ZZC07' THEN sum(INVOSUB.QUANTITY)-140 ELSE sum(INVOSUB.QUANTITY) END) AS 數量 FROM INVOSUB LEFT JOIN CUST AS cust ON cust.CUST_NO=INVOSUB.cust_no WHERE INVOSUB.CORD_NO=''  {0} GROUP BY cust.custnm2, INVOSUB.ITEM_NO,cust.cust_no) a LEFT JOIN (SELECT cust.cust_no 客戶代號,cust.custnm2 AS 客戶簡稱,INVOSUB.ITEM_NO AS 運輸架品號,sum(INVOSUB.QUANTITY) AS 數量 FROM INVOSUB LEFT JOIN CUST AS cust ON cust.CUST_NO=INVOSUB.cust_no WHERE INVOSUB.CORD_NO='' {0} GROUP BY cust.custnm2, INVOSUB.ITEM_NO,cust.cust_no HAVING SUM(INVOSUB.QUANTITY) < 0) b ON a.客戶簡稱 = b.客戶簡稱 AND a.運輸架品號 = b.運輸架品號 WHERE a.數量>0 GROUP BY a.客戶簡稱,a.運輸架品號,a.客戶代號
KnifeSet= select a.排程編號,a.品號,b.母件品名,a.子件品號,a.子件品名,a.預計開工日,a.類別,a.位置,a.需求量 from  ( SELECT DISTINCT MKORDSUB.LOT_NO 排程編號 , MKORDSUB.item_no AS 品號, A22_FAB.STR_DATE AS 預計開工日, item.ITEM_NO 子件品號,item.ITEMNM 子件品名,class.C_NAME 類別,ITEM.PLACE 位置,PQTY 需求量 FROM A22_FAB, CORDSUB, MKORDSUB, mkordis, item, CLASS WHERE MKORDSUB.FCLOSE <> 1 AND A22_FAB.STR_DATE >={0} AND A22_FAB.STR_DATE <= {1} 	 and a22_fab.FAB_USER>=100 	 	 and a22_fab.FAB_USER<=199 AND ((MKORDSUB.SCLOSE <> '結案' OR MKORDSUB.SCLOSE IS NULL) AND (mkordis.SCLOSE <> '結案' OR mkordis.SCLOSE IS NULL)) AND class.C_NAME like '%刀套%' AND CORDSUB.TRN_NO = A22_FAB.CORD_no AND CORDSUB.SN = A22_FAB.CORD_SN AND MKORDSUB.CORD_NO = CORDSUB.trn_no AND MKORDSUB.CORD_SN = CORDSUB.sn AND mkordis.LOT_NO = MKORDSUB.LOT_NO AND item.ITEM_NO = mkordis.ITEM_NO AND CLASS.CLASS = item.CLASS ) a left join  ( select distinct CCS,a.母件品號,a.母件品名,b.子件品號,b.子件品名 from ( SELECT BOM_NO CCS ,BOMS_NO 母件品號 , item.ITEMNM 母件品名 FROM BOMsub,item where  item.ITEM_NO = BOMSUB.BOMS_NO      AND SUBSTRING (item.ITEM_NO, 1, 1) = 'p' AND (SUBSTRING (item.ITEM_NO,5,1) = '-' OR SUBSTRING (item.ITEM_NO,4,1) = '-' ) AND ((LEN(item.ITEM_NO) - LEN(REPLACE(item.ITEM_NO, '-', ''))) / LEN('-')) =2  ) a  left join (select BOMsub.BOM_NO 母件品號, boms_no 子件品號,item.ITEMNM 子件品名 FROM BOMsub ,item where BOMsub.boms_no = item.ITEM_NO ) b on a.母件品號 = b.母件品號 ) b on a.品號 = b.CCS and a.子件品號 = b.子件品號
SupplierShortage_Urge= SELECT URGE_ITEM.trn_no AS 催料單號, ORIGIN_TRN_NO AS '採購/加工單', fjwsql.dbo.SORD.TRN_DATE AS 開單日期, URGE_ITEM.FACT_NO AS 廠商代碼, factnm2 AS 廠商簡稱, ITEM_NO AS 品號, itemnm AS 品名規格, D_DATE AS 催料預交日, LEFT(sum(quantity), CHARINDEX('.', sum(quantity)) - 1) AS 催料數量, '' AS 未交量 ,URGE_ITEM.SOITEM_NO 加工代號 FROM URGE_ITEM LEFT JOIN fjwsql.dbo.fact ON URGE_ITEM.fact_no = fact.fact_no LEFT JOIN fjwsql.dbo.SORD ON urge_item.ORIGIN_TRN_NO = sord.TRN_NO WHERE URGE_ITEM.trn_no ={0} {1} {2} {3} {4} GROUP BY ORIGIN_TRN_NO, URGE_ITEM.FACT_NO, ITEM_NO, itemnm, D_DATE, factnm2, fjwsql.dbo.SORD.TRN_DATE, URGE_ITEM.trn_no,URGE_ITEM.SOITEM_NO ORDER BY URGE_ITEM.FACT_NO ASC, ITEM_NO ASC
Orders_StartDay=SELECT DISTINCT item_22.pline_no 產線代號,cust.custnm2 客戶簡稱, mkordsub.lot_no 製造批號,mkordsub.item_no CCS,a22_fab.ol_close 是否完工,a22_fab.sale_desc 預計上線日, a22_fab.user_field04 未如期領料說明1,a22_fab.user_field06 未如期領料說明2,a22_fab.user_field09 未如期領料說明3,a22_fab.str_date 預計開工日 , (CASE WHEN substring(a22_fab.str_date, 7, 2) <=25 THEN substring(a22_fab.str_date, 1, 6) WHEN substring(a22_fab.str_date, 7, 2) >=25 THEN CASE WHEN substring(a22_fab.str_date, 5, 2) = 12 THEN (cast(substring(a22_fab.str_date, 1, 4)+1 AS varchar) + '01') ELSE substring(a22_fab.str_date, 1, 6)+1 END END) 計算月份 FROM cordsub, item_22, a22_fab, mkordsub, cust WHERE item_22.item_no = cordsub.item_no AND cordsub.trn_no = a22_fab.cord_no AND cordsub.sn = a22_fab.cord_sn AND cordsub.trn_no = mkordsub.cord_no AND cust.cust_no =cordsub.cust_no AND cordsub.sn = mkordsub.cord_sn AND {0}<= a22_fab.str_date AND a22_fab.str_date<={1} AND 100<=item_22.pline_no AND item_22.pline_no<=199 and mkordsub.SCLOSE <> '結案' and mkordsub.FCLOSE <> '1'  ORDER BY 預計開工日,產線代號 ASC
Waitingfortheproduction_Hor= SELECT a.*,SUBSTRING(工作站狀態資料表.實際完成時間,1,8) 實際完成時間,工作站狀態資料表.狀態,(CASE a.產線代號 WHEN 1 THEN 組裝工時*60*60 WHEN 2 THEN 組裝工時*60*60 WHEN 4 THEN ((CAST(刀臂點數 AS float)+CAST(刀套點數 AS float))*60*60) WHEN 5 THEN (CAST(刀鍊點數 AS float)*60*60) WHEN 6 THEN (CAST(全油壓點數 AS float)*60*60) END) 標準工時 FROM (SELECT (case FAB_USER when '100' then '1' when '110' then '2' end)   產線代號, sw_MKORDSUB.LOT_NO 排程編號,a22_fab.USER_FIELD07 AS 組裝預計完工日, A22_FAB.STR_DATE+'080000'  上線日,CUSTNM2 客戶簡稱, (case FAB_USER when '100' then '1' when '110' then '2' end) 工作站編號,sw_MKORDSUB.SCLOSE 製令狀態 FROM SW.FJWSQL.dbo.A22_FAB LEFT JOIN SW.FJWSQL.dbo.CORD AS sw_CORD ON sw_CORD.trn_no = A22_FAB.cord_no LEFT JOIN SW.FJWSQL.dbo.CORDSUB AS sw_CORDSUB ON sw_CORDSUB.TRN_NO = A22_FAB.CORD_no AND sw_CORDSUB.SN = A22_FAB.CORD_SN LEFT JOIN SW.FJWSQL.dbo.CUST AS sw_CUST ON sw_CUST.CUST_NO = sw_CORD.CUST_NO LEFT JOIN SW.FJWSQL.dbo.MKORDSUB AS sw_MKORDSUB ON sw_MKORDSUB.CORD_NO = sw_CORDSUB.trn_no AND sw_MKORDSUB.CORD_SN = sw_CORDSUB.sn LEFT JOIN SW.FJWSQL.dbo.citem AS sw_citem ON sw_CORDSUB.item_no = sw_citem.item_no LEFT JOIN SW.FJWSQL.dbo.item_22 AS sw_item_22 ON sw_CORDSUB.item_no = sw_item_22.item_no LEFT JOIN SW.FJWSQL.dbo.ITEM AS sw_item ON sw_item.ITEM_NO = sw_item_22.item_no WHERE sw_MKORDSUB.FCLOSE <> 1 AND A22_FAB.STR_DATE > 20210101 AND A22_FAB.STR_DATE <= {3} AND 100<=FAB_USER AND FAB_USER<=199 ) a LEFT JOIN 工作站狀態資料表 ON 工作站狀態資料表.排程編號 = a.排程編號 AND 工作站狀態資料表.工作站編號 = a.產線代號 LEFT JOIN 臥式工藝 ON 臥式工藝.機種編號 = SUBSTRING(a.排程編號, 1, CHARINDEX('-', a.排程編號) - 1) WHERE  ((組裝日>={0} AND 組裝日 <={3}) OR (實際完成時間 IS NULL OR LEN(實際完成時間) =0)) and LEN(客戶簡稱)>0 {1}  and   (SUBSTRING(實際完成時間,1, 8) >={2} OR 實際完成時間 IS NULL OR 實際完成時間 = '') AND ((a.製令狀態 = '結案' AND 狀態 IS NOT NULL) OR (a.製令狀態 = '未結')) ORDER BY 上線日
[Parameter]
Orders_Finished= AND cordsub.sclose  = '結案' 
Orders_Unfinished=AND cordsub.sclose  <> '結案' 
Orders_Scheduled=AND cordsub.sclose  <> '結案'    AND (CORDSUB.TRN_NO + CORDSUB.SN) IN   (SELECT A22_FAB.CORD_NO + A22_FAB.CORD_SN  FROM A22_FAB AS A22_FAB WHERE  CORDSUB.TRN_NO = A22_FAB.CORD_NO AND CORDSUB.SN = A22_FAB.CORD_SN)   
Orders_Unscheduled=AND cordsub.sclose  <> '結案'  AND (CORDSUB.TRN_NO + CORDSUB.SN) NOT IN   (SELECT A22_FAB.CORD_NO + A22_FAB.CORD_SN  FROM A22_FAB AS A22_FAB WHERE  CORDSUB.TRN_NO = A22_FAB.CORD_NO AND CORDSUB.SN = A22_FAB.CORD_SN)
Orders_Stock= AND cordsub.sclose  <> '結案'  and mkordsub.sclose = '結案'
Orders_Unstock= AND cordsub.sclose  <> '結案'   and mkordsub.sclose <> '結案'
UntradedCustomer_Time=and 最後交易日 > {0} and 最後交易日 < {1} 
materialrequirementplanning_Name= AND item.ITEMNM like '%{0}%'
materialrequirementplanning_item= AND ITEMIOS.ITEM_NO like '%{0}%'
materialrequirementplanning_dtl= AND ITEMIOS.ITEM_NO = '{0}' 
Total_warehouse= ITEM_GD.GDNO
Total_type= ITEM.CLASS
class_name= ITEM.CLASS
InactiveInventory_warehouse=ITEM_GD.GDNO
Scrapped_personnel= ITEMIO.STOCKNAME
lot_no= itemio.LOT_NO
mkord_no= itemio.mkord_no
Transport= INVOSUB.ITEM_NO
supplier_no=  AND URGE_ITEM.FACT_NO = '{0}' 
supplier_name=  AND factnm2 like '%{0}%' 
item_no=    AND item_no LIKE '%{0}%' 
SupplierShortage_date=  AND d_date BETWEEN {0} AND {1}
in_house=  (SELECT Max(itemio.trn_date) FROM itemios LEFT JOIN itemio ON itemios.io = itemio.io AND itemios.trn_no = itemio.trn_no WHERE itemios.io = '2' AND itemios.mkord_no = mkordsub.trn_no AND itemios.mkord_sn = mkordsub.sn AND itemio.s_desc < > '歸還' AND itemio.mk_type = '成品入庫') 入庫日,
[Get_Item]
InactiveInventory_House=SELECT distinct GDNO as 儲位 FROM ITEM_GD where GDNO <> '治具倉(立)'
InactiveInventory_Class=SELECT CLASS,C_NAME FROM CLASS where class  like '%-H'
Scrapped_Man=SELECT distinct ITEMIO.STOCKNAME as 報廢人 FROM ITEM AS ITEM  LEFT JOIN ITEMIOS AS ITEMIOS ON ITEM.ITEM_NO = ITEMIOS.ITEM_NO AND ITEMIOS.IO='3'  LEFT JOIN ITEMIO AS ITEMIO ON ITEMIOS.IO=ITEMIO.IO AND ITEMIOS.TRN_NO=ITEMIO.TRN_NO  LEFT JOIN DEP AS DEP ON ITEMIO.D_NO=DEP.S_NO WHERE ITEMIOS.IRQTY <> 0 AND ITEMIOS.WASTES_SW2='Y' AND ITEMIOS.TRN_DATE >= {0} AND ITEMIOS.TRN_DATE <= {1}
Item_No=JHM5-0001A04,JHM5-0033A01,JHM5-0037A01,JHM5-0033A02,ASSASSA
MaxOrder= select max( TRN_NO)  催料表日期 from urge_item
Shortage= select max( TRN_NO)  繳交日期 from urge_item
[db_name]
inikey=TEST
[41vhix4fYtGPDHbo2OiprQ==]
inikey1=tJARhN5XPIuh3cUW5Q0TrQ==
inikey=41vhix4fYtGPDHbo2OiprQ==
inikey2=kp02nPT/BEbIj9IcEn0aUQ==
inikey3=i1zbC1szER00ixO+TGqRMA==
inikey4=gOkD7Wci3cZoYkcj5dns3Q==